# Κυβερνοασφάλεια **Λειτουργίες Ασφαλείας**

---

Οι **Λειτουργίες Ασφαλείας** συχνά εντάσσονται σε ένα SOC ("Κέντρο Λειτουργιών Ασφαλείας"). Οι όροι χρησιμοποιούνται εναλλακτικά.  
Συνήθως, η ευθύνη του SOC είναι να εντοπίζει απειλές στο περιβάλλον και να αποτρέπει την εξέλιξή τους σε δαπανηρά προβλήματα.

---

## SIEM ("Διαχείριση Πληροφοριών και Γεγονότων Ασφαλείας")

Τα περισσότερα συστήματα παράγουν αρχεία καταγραφής (logs) που συχνά περιέχουν σημαντικές πληροφορίες ασφαλείας.  
Ένα **γεγονός** είναι απλώς παρατηρήσεις που μπορούμε να εξάγουμε από τα logs και πληροφορίες του δικτύου, για παράδειγμα:

- Χρήστες που συνδέονται
- Επιθέσεις που παρατηρούνται στο δίκτυο
- Συναλλαγές σε εφαρμογές

Ένα **περιστατικό** είναι κάτι αρνητικό που πιστεύουμε ότι θα επηρεάσει τον οργανισμό μας. Μπορεί να είναι μια βεβαιωμένη απειλή ή η πιθανότητα μιας τέτοιας απειλής. Το SOC πρέπει να προσπαθήσει να προσδιορίσει ποια γεγονότα μπορούν να θεωρηθούν πραγματικά περιστατικά και να απαιτούν αντίδραση.

Το SIEM επεξεργάζεται ειδοποιήσεις βασισμένες σε logs από διάφορους αισθητήρες και παρατηρητές στο δίκτυο, καθένας από τους οποίους μπορεί να παράγει σημαντικές ειδοποιήσεις για το SOC. Το SIEM μπορεί επίσης να προσπαθήσει να συσχετίσει πολλαπλά γεγονότα για να καθορίσει μια ειδοποίηση.

Τα SIEM επιτρέπουν συνήθως την ανάλυση γεγονότων από τους εξής τομείς:

- Δίκτυο
- Υπολογιστής/Host
- Εφαρμογές

Τα γεγονότα από το δίκτυο είναι τα πιο συνηθισμένα, αλλά τα λιγότερο πολύτιμα καθώς δεν περιέχουν όλο το πλαίσιο των συμβάντων. Το δίκτυο συνήθως δείχνει ποιος επικοινωνεί πού, μέσω ποιων πρωτοκόλλων και πότε, αλλά όχι τις λεπτομέρειες σχετικά με το τι συνέβη, σε ποιον και γιατί.

Τα γεγονότα από τον υπολογιστή/host παρέχουν περισσότερες πληροφορίες σχετικά με το τι συνέβη και σε ποιον. Προκλήσεις όπως η κρυπτογράφηση δεν είναι πλέον εμπόδιο και αποκτάται μεγαλύτερη ορατότητα σε όσα συμβαίνουν. Πολλά SIEM εμπλουτίζονται με λεπτομέρειες για όσα συμβαίνουν στους ίδιους τους hosts, όχι μόνο από το δίκτυο.

Τα γεγονότα από τις εφαρμογές είναι αυτά που συνήθως επιτρέπουν στο SOC να κατανοήσει καλύτερα τι συμβαίνει. Παρέχουν πληροφορίες σχετικά με την Τριπλή Α (AAA: "Authentication, Authorization, Account"), περιλαμβάνοντας λεπτομέρειες για την απόδοση της εφαρμογής και τις ενέργειες των χρηστών.

Για να κατανοήσει ένα SIEM τα γεγονότα από εφαρμογές, συνήθως απαιτείται εργασία από την ομάδα SOC ώστε το SIEM να κατανοήσει αυτά τα γεγονότα, καθώς η υποστήριξη δεν περιλαμβάνεται συνήθως "έτοιμη προς χρήση". Πολλές εφαρμογές είναι ιδιόκτητες ενός οργανισμού και το SIEM δεν έχει ήδη γνώση των δεδομένων που προωθούν οι εφαρμογές.

---

## Προσωπικό SOC

Η στελέχωση ενός SOC ποικίλλει σημαντικά ανάλογα με τις απαιτήσεις και τη δομή του οργανισμού. Σε αυτή την ενότητα δίνεται μια σύντομη επισκόπηση των τυπικών ρόλων:

![SOC Οργάνωση](https://www.w3schools.com/cybersecurity/img_soc-organization.svg)

Όπως και σε άλλες οργανωμένες ομάδες, ένας ρόλος ορίζεται για την ηγεσία του τμήματος. Ο **Διευθυντής SOC** καθορίζει τη στρατηγική και τις τακτικές για την αντιμετώπιση των απειλών στον οργανισμό.

Ο **Αρχιτέκτονας SOC** είναι υπεύθυνος να εξασφαλίσει ότι τα συστήματα, οι πλατφόρμες και η συνολική αρχιτεκτονική μπορούν να υποστηρίξουν τα μέλη της ομάδας για την εκτέλεση των καθηκόντων τους. Βοηθά στη δημιουργία κανόνων συσχέτισης δεδομένων και διασφαλίζει ότι τα εισερχόμενα δεδομένα πληρούν τις απαιτήσεις της πλατφόρμας.

Ο **Αναλυτής Ηγέτης** είναι υπεύθυνος να αναπτύσσονται και να συντηρούνται διαδικασίες (playbooks) ώστε οι αναλυτές να μπορούν να βρίσκουν τις πληροφορίες που απαιτούνται για την αξιολόγηση των ειδοποιήσεων και των πιθανών περιστατικών.

Οι **Αναλυτές Επιπέδου 1** είναι οι πρώτοι ανταποκριτές σε ειδοποιήσεις. Το καθήκον τους είναι να αξιολογούν τις ειδοποιήσεις και να προωθούν τυχόν προβλήματα σε ανώτερο αναλυτή.

Οι **Αναλυτές Επιπέδου 2** έχουν μεγαλύτερη εμπειρία και τεχνική γνώση. Πρέπει επίσης να διασφαλίζουν ότι τυχόν προβλήματα στην επίλυση ειδοποιήσεων προωθούνται στον Αναλυτή Ηγέτη για τη συνεχή βελτίωση του SOC. Μαζί με τον Αναλυτή Ηγέτη, προωθούν τα περιστατικά στην **Ομάδα Αντιμετώπισης Περιστατικών (IRT)**.

Η **IRT ("Incident Response Team")** αποτελεί φυσική επέκταση της ομάδας SOC. Αναπτύσσεται για να αντιμετωπίσει και να λύσει τα προβλήματα που επηρεάζουν τον οργανισμό.

Οι **Δοκιμαστές Διείσδυσης (Penetration Testers)** υποστηρίζουν επίσης την άμυνα. Έχουν λεπτομερή γνώση της λειτουργίας των επιτιθέμενων και μπορούν να βοηθήσουν στην ανάλυση αιτίας και στην κατανόηση των εισβολών. Η συγχώνευση των ομάδων επίθεσης και άμυνας αναφέρεται ως **Purple Teaming** και θεωρείται βέλτιστη πρακτική.

---

## Αλυσίδες Κλιμάκωσης

Ορισμένες ειδοποιήσεις απαιτούν άμεσες ενέργειες. Είναι σημαντικό το SOC να έχει καθορίσει διαδικασίες για το ποιον να ενημερώνει όταν συμβαίνουν διαφορετικά περιστατικά. Τα περιστατικά μπορεί να αφορούν διάφορες επιχειρησιακές μονάδες, και το SOC πρέπει να γνωρίζει ποιος να ενημερωθεί, πότε και με ποιο μέσο επικοινωνίας.

Παράδειγμα αλυσίδας κλιμάκωσης για περιστατικά που επηρεάζουν ένα τμήμα του οργανισμού:

1. Δημιουργία περιστατικού στο κατάλληλο σύστημα παρακολούθησης, αναθέτοντάς το στο σωστό τμήμα ή άτομο(α)
2. Αν δεν υπάρξει άμεση δράση: αποστολή SMS και email στον κύριο υπεύθυνο
3. Αν ακόμα δεν υπάρξει άμεση δράση: τηλεφωνική επικοινωνία με τον κύριο υπεύθυνο
4. Αν ακόμα δεν υπάρξει άμεση δράση: τηλεφωνική επικοινωνία με τον δευτερεύοντα υπεύθυνο

---

## Κατηγοριοποίηση Περιστατικών

Τα περιστατικά πρέπει να ταξινομούνται σύμφωνα με:

- Κατηγορία
- Κρισιμότητα
- Ευαισθησία

Ανάλογα με την ταξινόμηση του περιστατικού, το SOC μπορεί να λάβει διαφορετικά μέτρα για την επίλυσή του.

Η **κατηγορία** καθορίζει τον τρόπο αντίδρασης. Υπάρχουν πολλοί τύποι περιστατικών και είναι σημαντικό το SOC να κατανοεί τι σημαίνει κάθε τύπος για τον οργανισμό. Παραδείγματα:

- Εσωτερική παραβίαση
- Κακόβουλο λογισμικό σε υπολογιστή πελάτη
- Δούρειος ίός που εξαπλώνεται στο δίκτυο
- Επιθέσεις DDoS
- Διαρροή διαπιστευτηρίων

Η **κρισιμότητα** καθορίζεται από το πόσα συστήματα επηρεάζονται, την πιθανή ζημία αν το περιστατικό δεν αντιμετωπιστεί, τα εμπλεκόμενα συστήματα και άλλα. Καθορίζει πόσο γρήγορα πρέπει να απαντήσει η ομάδα.

Η **ευαισθησία** καθορίζει ποιος πρέπει να ενημερωθεί για το περιστατικό. Ορισμένα περιστατικά απαιτούν ακραία διακριτικότητα.

---

## SOAR ("Ορχήστρωση, Αυτοματοποίηση και Αντιμετώπιση Απειλών")

Για να αντιμετωπιστούν οι εξελίξεις των επιτιθέμενων, η **αυτοματοποίηση** είναι κρίσιμη για ένα σύγχρονο SOC ώστε να αντιδρά γρήγορα. Το SOAR παρέχει εργαλεία για αυτόματη ορχήστρωση λύσεων και αντιμετώπιση απειλών.

Η στρατηγική SOAR εξασφαλίζει ότι το SOC χρησιμοποιεί **δράσιμα δεδομένα** για την αντιμετώπιση απειλών που εξελίσσονται σε πραγματικό χρόνο. Σε παραδοσιακά περιβάλλοντα, οι επιτιθέμενοι χρειάζονται πολύ λίγο χρόνο για να εξαπλωθούν σε γειτονικά συστήματα, ενώ οι οργανισμοί καθυστερούν να εντοπίσουν τις απειλές. Το SOAR βοηθά στην αντιμετώπιση αυτής της καθυστέρησης.

Το SOAR περιλαμβάνει έννοιες όπως **IAC ("Infrastructure as Code")** για την αποκατάσταση απειλών και **SDN ("Software Defined Networking")** για ευκολότερο έλεγχο πρόσβασης.

---

## Τι να παρακολουθούμε;

Τα γεγονότα μπορούν να συλλεχθούν από πολλές συσκευές, αλλά πώς αποφασίζουμε τι να συλλέξουμε; Θέλουμε τα logs να έχουν υψηλή ποιότητα: **ακριβή, σχετική και ταυτοποιητική πληροφορία** για να σταματάμε γρήγορα τους επιτιθέμενους. Θέλουμε επίσης να δυσκολεύουμε τους επιτιθέμενους να παρακάμψουν τις ειδοποιήσεις.

Παρακάτω είναι δείκτες για τον εντοπισμό επιτιθέμενων και η δυσκολία αλλαγής τους:

| Δείκτης | Δυσκολία αλλαγής |
|---------|-----------------|
| Αθροίσματα ελέγχου αρχείων (File checksums & hashes) | Πολύ εύκολο |
| Διευθύνσεις IP | Εύκολο |
| Ονόματα domain | Απλό |
| Αρθραδικαστικά/Host στοιχεία | Ενοχλητικό |
| Εργαλεία | Προκλητικό |
| Τακτικές, Τεχνικές και Διαδικασίες (TTP) | Δύσκολο |

- Τα checksums και τα hashes αρχείων βοηθούν στον εντοπισμό γνωστών κακόβουλων λογισμικών ή εργαλείων. Οι επιτιθέμενοι μπορούν να τα αλλάξουν εύκολα.
- Οι διευθύνσεις IP αλλάζουν εύκολα μέσω άλλων hosts ή υπηρεσιών cloud/VPS.
- Τα domain names μπορούν να επαναρυθμιστούν γρήγορα από επιτιθέμενους, π.χ. με DGA.
- Τα στοιχεία δικτύου/hosts είναι πιο δύσκολα να αλλάξουν και αφήνουν ίχνη.
- Τα εργαλεία είναι ακόμη πιο δύσκολα να τροποποιηθούν λόγω της συμπεριφοράς τους.
- Η ανίχνευση των TTP καθιστά ακόμη πιο δύσκολη την επίτευξη στόχων από τους επιτιθέμενους (π.χ. spear-phishing + peer-to-peer pivoting).

---
