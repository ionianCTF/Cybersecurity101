# Ασφάλεια στον Κυβερνοχώρο **Web Εφαρμογές**

## Εισαγωγή
Οι **Web εφαρμογές** είναι απαραίτητες για σχεδόν κάθε δραστηριότητα, είτε για πρόσβαση στο Internet είτε για απομακρυσμένο έλεγχο συσκευών. Σε αυτό το εισαγωγικό μάθημα θα καλύψουμε τα βασικά της ασφάλειας web εφαρμογών.

## Το πρωτόκολλο HTTP
Το **HTTP** είναι το πρωτόκολλο που επιτρέπει στους browsers και τις εφαρμογές να λαμβάνουν περιεχόμενο όπως HTML, CSS, εικόνες και βίντεο.

## URLs, Παράμετροι Query και Scheme
Παράδειγμα URL:
````
https://www.google.com/search?q=w3schools+cyber+security&ie=UTF-8
````
Στοιχεία URL:
- Domain: google.com
- Script: /search
- Query Parameters: q, ie

Το `/` δείχνει την κορυφαία διαδρομή στον server. Το `?` ξεκινά τις παραμέτρους εισόδου. Το `&` διαχωρίζει διαφορετικές παραμέτρους.

Το **Scheme** καθορίζει το πρωτόκολλο (HTTP, HTTPS, FTP, SSH, SMB). Αν δεν οριστεί, η εφαρμογή αποφασίζει ποιο πρωτόκολλο να χρησιμοποιήσει.

## HTTP Headers
Το HTTP χρησιμοποιεί διάφορα headers, κάποια προσαρμοσμένα στην εφαρμογή και άλλα καθιερωμένα.
Παράδειγμα HTTP request:
````http
GET /search?q=w3schools+cyber+security&ie=UTF-8 HTTP/1.1
Host: google.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) ...
Accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8
Referer: https://w3schools.com/
Accept-Encoding: gzip, deflate
Cookie: cookie1=value1;cookie2=value2
````

**Επεξήγηση Headers:**
| Header | Εξήγηση |
|--------|---------|
| GET /search... HTTP/1.1 | Η μέθοδος GET ζητά πρόσβαση στην εφαρμογή. Περιλαμβάνει path, query parameters και έκδοση HTTP |
| Host: google.com | Ορίζει την υπηρεσία του server που θέλουμε να χρησιμοποιήσουμε |
| User-Agent | Αναγνωρίζει τον client (browser, έκδοση, λειτουργικό σύστημα) |
| Accept | Καθορίζει ποιο περιεχόμενο μπορεί να δεχτεί ο client |
| Referer | Από ποιο site ήρθε ο client |
| Accept-Encoding | Τι μορφές συμπίεσης/κωδικοποίησης δέχεται ο client |
| Cookie | Τιμές που ο server ζήτησε να επαναφέρει ο client |

**Response example:**
````http
HTTP/1.1 200 OK
Content-Type: text/html
Set-Cookie: <τιμή cookie>
<περιεχόμενο ιστοσελίδας>
````

**Response Headers:**
| Header | Εξήγηση |
|--------|---------|
| HTTP/1.1 200 OK | Κωδικός απάντησης HTTP |
| Content-Type: text/html | Τύπος περιεχομένου (HTML, JSON, XML) |
| Set-Cookie | Τιμές που ο client πρέπει να θυμάται |

## HTTP Verbs
| Μέθοδος | Χρήση |
|---------|------|
| GET | Ανάκτηση δεδομένων μέσω Query Parameters |
| POST | Αποστολή δεδομένων στο σώμα του request, π.χ. δημιουργία ή upload μεγάλου όγκου δεδομένων |
| PUT | Εγγραφή ή ενημέρωση δεδομένων στον server |
| DELETE | Διαγραφή ενός resource |
| PATCH | Ενημέρωση ενός resource με νέα τιμή |

## HTTP Response Codes
| Κωδικός | Σημασία |
|---------|---------|
| 200 | Η εφαρμογή επέστρεψε κανονικά |
| 301 | Μόνιμη ανακατεύθυνση σε νέο location |
| 302 | Προσωρινή ανακατεύθυνση, δεν χρειάζεται ο client να αποθηκεύσει |
| 400 | Ο client έκανε λανθασμένο request |
| 403 | Απαγορευμένη πρόσβαση, απαιτείται authorization |
| 404 | Το resource δεν βρέθηκε |
| 500 | Σφάλμα server κατά την επεξεργασία του αιτήματος |

## REST
Οι REST υπηρεσίες χρησιμοποιούν HTTP Verbs και Response Codes για τη λειτουργικότητα. Παράδειγμα REST URL:
````
http://example.com/users/search/w3schools
````
| Παράμετρος | Σχόλιο |
|------------|--------|
| users | Πρόσβαση στην ενότητα χρηστών |
| search | Πρόσβαση στη λειτουργία αναζήτησης |
| w3schools | Ο χρήστης που αναζητείται |

## Sessions & State
HTTP δεν έχει μηχανισμό για αναγνώριση επαναλαμβανόμενων επισκεπτών. Για αυτό χρησιμοποιούνται **cookies**, GET/POST parameters ή άλλα headers.

**Κοινά cookies:**
- PHPSESSID
- JSESSIONID
- ASP.NET_SessionID

Αν οι τιμές session είναι εύκολα μαντέψιμες, ένας επιτιθέμενος μπορεί να εμφανιστεί ως άλλος χρήστης.

Άλλες client-side μέθοδοι:
- JWT (JSON Web Tokens)
- ASP.Net ViewState

![HTTP Sessions](https://www.w3schools.com/cybersecurity/img_http-sessions.svg)

## Virtual Hosts (Vhosts)
Ένας web server μπορεί να φιλοξενεί πολλές εφαρμογές. Ο server χρησιμοποιεί το Host header για να στείλει το request στη σωστή εφαρμογή.

![Virtual Hosts](https://www.w3schools.com/cybersecurity/img_vhosts.svg)

## URL Encoding
# Πλήρης Κωδικοποίηση URL

Για μια εφαρμογή να μεταφέρει με ασφάλεια περιεχόμενο μεταξύ του διακομιστή και του πελάτη, ορισμένοι χαρακτήρες πρέπει να κωδικοποιούνται ώστε να μην επηρεάζουν το πρωτόκολλο. Για να διατηρηθεί η ακεραιότητα της επικοινωνίας, χρησιμοποιείται η κωδικοποίηση URL.

Η κωδικοποίηση URL αντικαθιστά τους μη ασφαλείς χαρακτήρες με ένα `%` και δύο δεκαεξαδικά ψηφία. Για παράδειγμα:

- Το ποσοστό (`%`) αντικαθίσταται με `%25`
- Ο κενός χώρος αντικαθίσταται με `%20`
- Τα εισαγωγικά (`"`) αντικαθίστανται με `%22`

Ένα εξαιρετικό εργαλείο για την ανάλυση κειμένου και την εκτέλεση λειτουργιών όπως η **αποκωδικοποίηση URL** είναι το **CyberChef**. Μπορείτε να το δοκιμάσετε στον browser σας εδώ: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)

**Σημείωση:** Παίξτε με το CyberChef και δείτε αν μπορείτε να αποκαλύψετε τι περιέχει το παρακάτω μήνυμα σε κωδικοποιημένους χαρακτήρες URL:

```
%48 %65 %6c %6c %6f %20 %64 %65 %61 %72 %20 %77 %33 %73 %63 %68 %6f %6f %6c %73 %20 %73 %74 %75 %64 %65 %6e %74 %2e %20 %48 %6f %70 %65 %20 %79 %6f %75 %20 %61 %72 %65 %20 %6c %65 %61 %72 %6e %69 %6e %67 %20 %73 %6f %6d %65 %74 %68 %69 %6e %67 %20 %74 %6f %64 %61 %79 %21
```
Για ασφαλή μεταφορά περιεχομένου, κάποια χαρακτήρες κωδικοποιούνται:
| Χαρακτήρας | Κωδικοποίηση |
|------------|--------------|
| % | %25 |
| space | %20 |
| " | %22 |

Εργαλείο: [CyberChef](https://gchq.github.io/CyberChef/)

## JavaScript
Χρησιμοποιείται για δυναμικό περιεχόμενο και μπορεί να εμπλέκεται σε επιθέσεις σε web εφαρμογές.

## Κρυπτογράφηση με TLS
Το HTTP δεν υποστηρίζει κρυπτογράφηση. Το HTTPS χρησιμοποιεί **TLS (Transport Layer Security)** για ασφαλή μεταφορά δεδομένων, αντικαθιστώντας το παλαιότερο SSL.
