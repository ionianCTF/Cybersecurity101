# In-Depth Transport and Link Layers
Τα συστήματα υπολογιστών συχνά χρειάζεται να επικοινωνούν μεταξύ τους· αυτό γίνεται βάζοντας τα στο ίδιο δίκτυο. Υπάρχουν πολλές τεχνολογίες που επιτρέπουν στους υπολογιστές να μιλούν σε διαφορετικά είδη δικτύων. Σε αυτή την ενότητα θα εμβαθύνουμε στα πρωτόκολλα που χρησιμοποιούνται στα περισσότερα δίκτυα.

Τα δίκτυα που χρησιμοποιούμε αποτελούνται από πολλά πρωτόκολλα, κάποια από τα οποία εξετάζουμε σε αυτό το μάθημα. Υπάρχουν πολλά άλλα πρωτόκολλα που μπορούν να έχουν πιθανούς κινδύνους ασφαλείας.

---

## TCP ("Transmission Control Protocol")
Όπως το IP χρησιμοποιεί διευθύνσεις IP, έτσι και το TCP/UDP χρησιμοποιεί **ports**. Μια θύρα (port) αριθμού 0–65535 καθορίζει ποια υπηρεσία θα επεξεργαστεί το αίτημα.

![TCP Header](https://www.w3schools.com/cybersecurity/img_tcp-header.png)

- 16 bits για source και destination ports.  
- Sequence και Acknowledgement numbers χρησιμοποιούνται στο **three-way handshake** και για αξιόπιστη μεταφορά δεδομένων.  
- Τα control bits υποδεικνύουν τον τύπο του πακέτου.  

---

## TCP 3-Way Handshake
Το TCP χρησιμοποιεί **τριπλό χειραψία** για να επιτρέψει τη σύνδεση δύο συστημάτων.

1. Ο Client στέλνει πακέτο με **SYN bit**, PRNG αριθμό στη Sequence field και target port. (**SYN packet**)  
2. Ο Server λαμβάνει το πακέτο, δημιουργεί απάντηση με **SYN+ACK** και PRNG Sequence number δικό του. (**SYN/ACK packet**)  
3. Ο Client απαντά με **ACK** επιβεβαιώνοντας τον αριθμό του Server.  

Αυτό είναι το γνωστό **SYN, SYN/ACK, ACK 3-way handshake**.

![TCP Handshake](https://www.w3schools.com/cybersecurity/img_tcp-handshake-1.svg)  

Στο Wireshark μπορούμε να δούμε τα τρία πακέτα και τα δεδομένα μετά τη σύνδεση.

![Wireshark Handshake](https://www.w3schools.com/cybersecurity/img_wireshark-handshake-1.png)  
![TCP Data](https://www.w3schools.com/cybersecurity/img_tcp-data.png)

> Σημείωση: Στην εικόνα φαίνεται μήνυμα για τους μαθητές του W3Schools.

---

## Spoofing Traffic
Υπάρχουν λίγοι περιορισμοί για τη δημιουργία πακέτων. Οι επιτιθέμενοι μπορούν να αλλάξουν οποιοδήποτε πεδίο στην κεφαλίδα. Αυτό λέγεται **spoofing**.

![Spoofing](https://www.w3schools.com/cybersecurity/img_spoofing-2.svg)

- Το TCP έχει κάποια ασφάλεια μέσω του PRNG Sequence numbers.  
- UDP και ICMP είναι πιο εύκολα στο spoofing.  
- Η δημιουργία πακέτων απαιτεί root / system δικαιώματα.

---

## UDP ("User Datagram Protocol")
Χρησιμοποιείται για traffic που δεν χρειάζεται τη σταθερότητα και ασφάλεια του TCP, π.χ. VOIP.  
- Έχει Source/Destination ports αλλά **χωρίς Sequence ή Control bits**.  
- Λιγότερο overhead → ταχύτερη μεταφορά.  
- Εύκολα spoofed.

![UDP Header](https://www.w3schools.com/cybersecurity/img_udp-header.png)

---

## Switched Networks
Τα συστήματα συνδέονται σε **LAN** μέσω **Switch**.  

- Χρησιμοποιείται **MAC Address** αντί IP για forwarding.  
- Παράδειγμα MAC: `FC:F8:AE:12:34:56`  
  - Τα πρώτα 3 octets → κατασκευαστής (OUI)  
  - Τελευταία 3 → μοναδικά για συσκευή  

[Μπορείτε να ελέγξετε MAC](https://www.adminsub.net/mac-address-finder/intel)

---

## ARP ("Address Resolution Protocol")
Το ARP μετατρέπει IP → MAC για LAN επικοινωνία.  
- Αν χρειάζεται routing, στέλνει πακέτα στο **Default Gateway**.  
- Κάθε συσκευή ελέγχει **ARP cache** πριν στείλει traffic.  
- Εντολή: `arp -a` (Linux/Windows)

```text
Alice: Does anyone know the MAC address of 192.168.10.10?
Bob: Sure thing Alice, here is my MAC Address.
```

---

## VLAN ("Virtual LAN")
VLAN επιτρέπει σε switch να προσθέσει **tags (VLAN ID)** σε frames.  
- Συστήματα με διαφορετικό VLAN ID δεν επικοινωνούν μεταξύ τους, ακόμη κι αν βρίσκονται στο ίδιο φυσικό LAN.
