# Nmap για Pentester: Σάρωση Ευπαθειών

**Κατηγορία:** Penetration Testing  
**Αρχικό άρθρο (πρωτότυπος):** https://www.hackingarticles.in/nmap-for-pentester-vulnerability-scan/  
**Δημοσιεύθηκε:** February 24, 2021  
**Ενημερώθηκε:** June 4, 2025  
**Συγγραφέας (πρωτότυπο):** Raj

---

## Εισαγωγή

Το Nmap Scripting Engine (NSE) είναι μία από τις πιο αποδοτικές δυνατότητες του Nmap, η οποία επιτρέπει στους χρήστες να προετοιμάζουν και να μοιράζονται σκριπτ για την αυτοματοποίηση των πολλών εργασιών που σχετίζονται με τα δίκτυα. Χάρις στην ταχύτητα και την αποδοτικότητα του Nmap, αυτά τα σκριπτ μπορούν να εκτελεστούν παράλληλα. Οι χρήστες μπορούν να επιλέξουν από ένα εύρος διαθέσιμων σκριπτ ή να δημιουργήσουν τα δικά τους ανάλογα με τις ανάγκες τους.

---

## Πίνακας Περιεχομένων

- Εισαγωγή  
- .nse Scripts  
  - ms17-010 Ευπάθεια  
  - Vsftpd backdoor  
  - SSL-Poodle Ευπάθεια  
  - RMI classloader ευπάθεια  
  - HTTP Slowloris ευπάθεια  
- Nmap-Vulners  
- Συμπέρασμα

---

Παρακάτω θα δούμε τη λίστα με όλα τα διαθέσιμα σκριπτ που εντοπίζουν ευπάθειες. Θα εκτελέσουμε κάθε σκριπτ ένα-ένα και θα ελέγξουμε για ευπάθειες.

```bash
cd /usr/share/nmap/scripts/
ls -al *vulns*
```

![Εικόνα 1](https://1.bp.blogspot.com/-GZ_HhdEfamg/YDYfcjwZSDI/AAAAAAAAuGA/crjOtlIcCNYtpi4Y8Hj0Iqp25YSEfJP1gCLcBGAsYHQ/s16000/1.png)

---

### ms17-010 Ευπάθεια

Αυτό το σκριπτ εντοπίζει αν ένας SMBv1 server σε συστήματα Microsoft είναι ευάλωτος στην απομακρυσμένη εκτέλεση κώδικα που είναι ευρέως γνωστή ως **EternalBlue**. Αυτή η ευπάθεια είχε εκμεταλλευτείται μαζικά από ransomware όπως το WannaCry. Λειτουργεί σε Windows XP, 2003, 7, 8, 8.1, 10, και server 2008, 2012 και 2016.

Όταν εκτελείτε αυτό το σκριπτ, μπορείτε να δείτε αν το σύστημα είναι ευάλωτο σε κρίσιμης φύσης ευπάθεια.

```bash
nmap --script smb-vuln-ms17-010.nse 192.168.1.16
```

![Εικόνα 2](https://1.bp.blogspot.com/-PizCjr7eIIg/YDYfjBihibI/AAAAAAAAuGE/5K0571nz294FDBztMrKvBmv4bSx2duiigCLcBGAsYHQ/s16000/2.png)

---

### Vsftpd backdoor

Αυτό το σκριπτ ελέγχει για την παρουσία της **ευπάθειας backdoor στο vsFTPd 2.3.4** προσπαθώντας να εκμεταλλευτεί τον backdoor με μια κακόβουλη εντολή.

```bash
nmap --script ftp-vsftpd-backdoor -p 21
```

![Εικόνα 3](https://1.bp.blogspot.com/-OsSbryCnl5A/YDYfoeaNenI/AAAAAAAAuGI/4_fDQgEoepwbj22NhMKUywdqDC1Vx7VvACLcBGAsYHQ/s16000/3.png)

---

### SSL-Poodle Ευπάθεια

Το SSL Poodle είναι επίθεση τύπου Man-in-the-Middle που εκμεταλλεύεται αδυναμίες στο SSL. Εκτελώντας αυτό το σκριπτ, μπορείτε να διαπιστώσετε αν το σύστημα είναι ευάλωτο.

```bash
nmap --script ssl-poodle 192.168.1.12
```

![Εικόνα 4](https://1.bp.blogspot.com/-4vefb9IwWrE/YDYfs5Vt8wI/AAAAAAAAuGQ/JUrqOpGzw-EiUYmb9si6OsSUq4cMpuO2ACLcBGAsYHQ/s16000/4.png)

---

### RMI classloader Ευπάθεια

Αυτό το σκριπτ ελέγχει αν το Java `rmiregistry` επιτρέπει τη φόρτωση κλάσεων από απομακρυσμένα URLs—μια προεπιλεγμένη συμπεριφορά που μπορεί να οδηγήσει σε απομακρυσμένη εκτέλεση κώδικα.

```bash
nmap --script=rmi-vuln-classloader -p 1099 192.168.1.12
```

![Εικόνα 5](https://1.bp.blogspot.com/-pzH7xtjk8nM/YDYfxJVuyWI/AAAAAAAAuGU/U-ihR3zOa3gcY6mXSCOfL_cLQnN6zx-hQCLcBGAsYHQ/s16000/5.png)

---

### HTTP Slowloris Ευπάθεια

Ελέγχει για την ευπάθεια σε web servers έναντι της επίθεσης Slowloris DoS—χωρίς να εκτελείται πραγματική επίθεση DoS. Το σκριπτ ανοίγει δύο ξεχωριστές συνδέσεις προς τον server και κάνει ένα βασικό αίτημα URL.

```bash
nmap --script http-slowloris-check 192.168.1.12
```

![Εικόνα 6](https://1.bp.blogspot.com/-_aTTGoexYzY/YDYf7AsXbQI/AAAAAAAAuGc/5IFlYKxx99ATRVPFnSFQHCQc2emeLw7BwCLcBGAsYHQ/s16000/6.png)

---

### SSL-CCS-Injection

Αυτό το σκριπτ ελέγχει αν ένας server είναι ευάλωτος στην ευπάθεια SSL/TLS "CCS Injection". Για να εκμεταλλευτεί κάποιος αυτή την ευπάθεια μέσω MITM, ο επιτιθέμενος περιμένει για μια νέα TLS σύνδεση και την ανταλλαγή μηνυμάτων ‘Hello’ μεταξύ Client και Server.

```bash
nmap --script ssl-ccs-injection -p 5432 192.168.1.12
```

![Εικόνα 7](https://1.bp.blogspot.com/-MaWiMxOkmms/YDYgFtLjAaI/AAAAAAAAuGo/OxlRItvPNUMMQ2H_OX36xMAi7SzQsBkkwCLcBGAsYHQ/s16000/7.png)

---

## Nmap-Vulners

Το **Nmap – Vulners** είναι ένα NSE σκριπτ που χρησιμοποιεί γνωστές υπηρεσίες για να παρέχει πληροφορίες σχετικά με ευπάθειες. Αυτό το σκριπτ εξαρτάται από τις πληροφορίες έκδοσης λογισμικού και γι' αυτό λειτουργεί σε συνδυασμό με την επιλογή `-sV`.

Μπορείτε να το εγκαταστήσετε από το GitHub και να ενημερώσετε τη βάση σκριπτ του NSE:

```bash
git clone https://github.com/vulnersCom/nmap-vulners /usr/share/nmap/scripts/vulners
nmap --script-updatedb
```

![Εικόνα 15](https://1.bp.blogspot.com/-hKEVE7GaYDQ/YDYgKhATYGI/AAAAAAAAuGw/uCrrqG11Cqw9sRyWqwkJGA2fqcNoeiIDwCLcBGAsYHQ/s16000/15.png)

Έπειτα, φορτώστε τα σκριπτ και ελέγξτε τις εκδόσεις υπηρεσιών στον στόχο:

```bash
nmap -sV -Pn 192.168.1.12 --script=vulners/vulners.nse
```

![Εικόνα 16](https://1.bp.blogspot.com/-eI4G9za55i4/YDYgRlW5a4I/AAAAAAAAuG0/tfE0kauvMfcvlZNDeeCR7Qg2iv-vsdJyQCLcBGAsYHQ/s16000/16.png)

![Εικόνα 17](https://1.bp.blogspot.com/-kDzi8DY2yvw/YDYggRR3_wI/AAAAAAAAuHA/rac2PDA0o7c9W-0lgOmr36n_lt_Yyiv3wCLcBGAsYHQ/s16000/17.png)

---

## Συμπέρασμα

Χρησιμοποιώντας τα σκριπτ του Nmap, μπορούμε να εντοπίσουμε ευπάθειες που υπάρχουν στα συστήματα—ένα πολύτιμο όφελος για τους Pen Testers.
