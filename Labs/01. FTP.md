
# Διαμόρφωση FTP σε Μη-Τυπική Θύρα (Customize Hydra Port Numbers - Μετάφραση)

Σε αυτό το εργαστήριο θα μάθετε πώς να **προσαρμόζετε τον αριθμό θύρας FTP** σε ένα στόχο και στη συνέχεια να χρησιμοποιήσετε το **Hydra** για να πραγματοποιήσετε επίθεση brute-force στην υπηρεσία FTP στη ρυθμισμένη μη-τυπική θύρα. Αυτή η δεξιότητα είναι πολύτιμη για penetration testers και επαγγελματίες ασφάλειας που πρέπει να αξιολογήσουν συστήματα τα οποία έχουν ρυθμιστεί με μη-προεπιλεγμένες (non-standard) θύρες FTP.

---

## Περιγραφή εργαστηρίου (λεπτομερώς)

Το εργαστήριο περιλαμβάνει:

1. Την **επεξεργασία του αρχείου ρύθμισης `vsftpd.conf`** στο για να ακούει ο FTP server σε μη-τυπική θύρα (π.χ. 2121 αντί για 21).
2. Επανεκκίνηση της υπηρεσίας FTP για να εφαρμοστούν οι αλλαγές.
3. Έλεγχο με `netstat` για επιβεβαίωση ότι ο `vsftpd` ακούει στη νέα θύρα.
4. Χρήση του **Hydra** με την επιλογή `-s` για να καθοριστεί η προσαρμοσμένη θύρα και εκτέλεση επίθεσης brute-force κατά της υπηρεσίας FTP σε αυτή τη θύρα.

> Αυτό είναι ένα *Guided Lab*: παρέχονται βήμα-βήμα οδηγίες για να εξασκηθείτε πρακτικά. Το εργαστήριο χαρακτηρίζεται ως **beginner** και έχει υψηλό ποσοστό ολοκλήρωσης και θετικές κριτικές.

---

## Βήμα 1 — Διαμόρφωση του FTP σε μη-τυπική θύρα

Από προεπιλογή, το FTP χρησιμοποιεί τη θύρα **21**. Η αλλαγή της θύρας μειώνει τον κίνδυνο αυτοματοποιημένων επιθέσεων που στοχεύουν τη θύρα προεπιλογής.

Ανοίξτε το αρχείο ρυθμίσεων με τον επεξεργαστή `nano`:

```bash
sudo nano /etc/vsftpd.conf
```

Προσθέστε ή τροποποιήστε την ακόλουθη γραμμή:

```text
listen_port=2121
```

![Προσθήκη listen_port](https://file.labex.io/namespace/93459dab-5a0f-4725-a867-c2ce335286d8/hydra/lab-customize-hydra-port-numbers/en/../assets/20250402-14-41-46-oC0oyyD9.png)

Σημειώσεις:
- Αν η παράμετρος `listen_port` δεν υπάρχει, προσθέστε την — καλό είναι να την τοποθετήσετε κοντά στην κορυφή του αρχείου.
- Αποθηκεύστε και κλείστε πατώντας `Ctrl+X`, έπειτα `Y` και `Enter` για επιβεβαίωση.

Επανεκκινήστε την υπηρεσία `vsftpd`:

```bash
sudo service vsftpd restart
```

Επιβεβαιώστε ότι ο server ακούει στη νέα θύρα:

```bash
sudo netstat -tulnp | grep vsftpd
```

Παράδειγμα εξόδου που αναμένεται:

```
tcp6       0      0 :::2121                 :::*                    LISTEN      1027/vsftpd
```

![Έλεγχος θύρας FTP](https://file.labex.io/namespace/93459dab-5a0f-4725-a867-c2ce335286d8/hydra/lab-customize-hydra-port-numbers/en/../assets/20250402-14-39-54-KZnhSX20.png)

Αν δείτε την καινούργια θύρα στην έξοδο, ο FTP server ακούει σωστά στη θύρα `2121` (ή την θύρα που επιλέξατε).

---

## Βήμα 2 — Προσδιορισμός θύρας με τις επιλογές `ftp` vs `hydra`

Το command-line πρόγραμμα `ftp` και το εργαλείο `hydra` έχουν διαφορετικές επιλογές για να καθορίσουν τη θύρα:

- Η εντολή `ftp` χρησιμοποιεί την επιλογή `-p` για να καθορίσει τη θύρα:

  ```bash
  ftp -p localhost 2121
  ```

- Το `hydra` χρησιμοποιεί την επιλογή `-s` για να καθορίσει τη θύρα. Είναι σημαντικό να θυμάστε αυτή τη διαφορά όταν προετοιμάζεστε για την επίθεση Hydra.

Παράδειγμα (μη-εκτελεστικό, μόνο για επίδειξη σύνταξης):

```bash
hydra -l ftpuser -P ~/project/password.txt localhost ftp -s 2121
```

![Παράδειγμα σύνταξης Hydra](https://file.labex.io/namespace/93459dab-5a0f-4725-a867-c2ce335286d8/hydra/lab-customize-hydra-port-numbers/en/../assets/20250402-14-47-53-PB21qQvx.png)

Συμπέρασμα: Για σύνδεση FTP μέσω `ftp` χρησιμοποιούμε `-p`, ενώ για επιθέσεις με `hydra` χρησιμοποιούμε `-s`.

---

## Βήμα 3 — Εκτέλεση επίθεσης FTP με Hydra στη προσαρμοσμένη θύρα

Τώρα θα χρησιμοποιήσουμε το Hydra για να πραγματοποιήσουμε επίθεση brute-force στην υπηρεσία FTP που τρέχει στη μη-τυπική θύρα. Χρησιμοποιήστε το αρχείο λίστας κωδικών που δημιουργήσατε (π.χ. `~/project/password.txt`).

Εκτέλεση Hydra (αντικαταστήστε `localhost` με τη διεύθυνση IP του IonianCTF VM αν χρειάζεται):

```bash
hydra -l ftpuser -P ~/project/password.txt localhost ftp -s 2121 -vV
```

Ανάλυση παραμέτρων:
- `hydra`: το εργαλείο Hydra.
- `-l ftpuser`: συγκεκριμένο όνομα χρήστη προς επίθεση.
- `-P ~/project/password.txt`: αρχείο με πιθανές κωδικούς.
- `localhost`: στόχος (χρησιμοποιήστε IP αν χρειάζεται).
- `ftp`: υπηρεσία προς επίθεση.
- `-s 2121`: προσαρμοσμένη θύρα (σημαντικό).
- `-vV`: verbose / πολύ λεπτομερές output για να βλέπετε τις προσπάθειες σε πραγματικό χρόνο.

Παράδειγμα επιτυχίας:

```
[ATTACKER] attacking ftp://localhost:2121/
[2121][ftp] host: localhost   login: ftpuser   password: password123
```

Αν δεν βρεθεί σωστή τιμή, το Hydra θα δοκιμάσει όλες τις λέξεις στο αρχείο και θα τερματίσει χωρίς επιτυχή σύνδεση.

**Σημαντική υπενθύμιση ασφάλειας:** Αυτό το εργαστήριο είναι εκπαιδευτικό. Μην χρησιμοποιείτε Hydra ή άλλες τεχνικές brute-force σε συστήματα χωρίς ρητή άδεια — είναι παράνομο και ανήθικο.

---

## Βήμα 4 — Επικύρωση σύνδεσης στην σωστή θύρα μετά την επίθεση

Επιβεβαιώστε ότι μπορείτε ακόμη να συνδεθείτε στον FTP server μετά την επίθεση (για να βεβαιωθείτε ότι η υπηρεσία λειτουργεί κανονικά).

Χρήση του `ftp` με `-p`:

```bash
ftp -p 2121 localhost
```

Συνδεθείτε με τα διαπιστευτήρια που δημιουργήθηκαν κατά τη ρύθμιση (παράδειγμα):

- Username: `ftpuser`
- Password: `password123`

![Είσοδος FTP](https://file.labex.io/namespace/93459dab-5a0f-4725-a867-c2ce335286d8/hydra/lab-customize-hydra-port-numbers/en/../assets/20250402-14-44-11-q072m3Ri.png)

Αν δεν μπορείτε να συνδεθείτε, ελέγξτε:
- Η υπηρεσία `vsftpd` τρέχει (`sudo netstat -tulnp | grep vsftpd`).
- Το `/etc/vsftpd.conf` περιέχει `listen_port=2121` (ή την θύρα που επιλέξατε).
- Δεν υπάρχουν firewall κανόνες που μπλοκάρουν την πρόσβαση στην προσαρμοσμένη θύρα.
- Χρησιμοποιείτε τα σωστά διαπιστευτήρια.

Η επιτυχής σύνδεση επιβεβαιώνει ότι ο FTP server λειτουργεί στη προσαρμοσμένη θύρα και ότι η επίθεση Hydra (αν εκτελέστηκε) δεν διέκοψε την υπηρεσία.

---

## Περίληψη

Σ’ αυτό το εργαστήριο:
- Αλλάξατε τη θύρα που ακούει ο `vsftpd` προσθέτοντας `listen_port=2121` στο `/etc/vsftpd.conf`.
- Επανεκκινήσατε την υπηρεσία `vsftpd`.
- Επιβεβαιώσατε με `netstat -tulnp | grep vsftpd` ότι ο server ακούει στη θύρα `2121`.
- Μάθατε τη διαφορά σύνταξης: `ftp -p` (client) vs `hydra -s` (Hydra).
- Εκτελέσατε (ή προετοιμάσατε) μια επίθεση Hydra με `-s 2121`.
- Επικυρώσατε τη σύνδεση μετά την επίθεση.

---

> **Σημείωση δεοντολογίας:** Χρησιμοποιείτε τις τεχνικές του εργαστηρίου μόνο σε περιβάλλοντα όπου έχετε σαφή άδεια να δοκιμάζετε την ασφάλεια συστημάτων.

